<?php
// get_image.php
require 'db_config.php'; // Include your database connection file

if (isset($_GET['id'])) {
    $imageId = $_GET['id'];

    try {
        $pdo = new PDO($dsn, $username, $password, $options);

        // Retrieve the image data and content type from the database
        // Assuming your table has 'id', 'mime_type', and 'image_data' columns
        $sql = "SELECT mime_type, image_data FROM images WHERE id = ?";
        $stmt = $pdo->prepare($sql);
        $stmt->execute([$imageId]);
        $result = $stmt->fetch(PDO::FETCH_ASSOC);

        if ($result) {
            // Set the appropriate content type header
            header("Content-Type: " . $result['mime_type']);
            // Output the image data directly
            echo $result['image_data'];
        } else {
            // Handle image not found
            header("HTTP/1.1 404 Not Found");
            echo "Image not found.";
        }
    } catch (PDOException $e) {
        // Handle database errors
        header("HTTP/1.1 500 Internal Server Error");
        echo "Database error: " . $e->getMessage();
    }
} else {
    // Handle missing ID
    header("HTTP/1.1 400 Bad Request");
    echo "Missing image ID.";
}
?>




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Display Photos</title>
</head>
<body>
    <h1>My Photo Gallery</h1>
    <div id="gallery">
        <!-- Images will be injected here by JavaScript -->
    </div>

    <script src="your_script.js"></script>
</body>
</html>




document.addEventListener('DOMContentLoaded', (event) => {
    const galleryElement = document.getElementById('gallery');
    const phpScriptUrl = 'fetch_images.php'; // The path to your PHP file

    fetch(phpScriptUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok: ' + response.statusText);
            }
            return response.json(); // Parse the JSON data from PHP
        })
        .then(images => {
            // Loop through the array of image data
            images.forEach(image => {
                const imgElement = document.createElement('img');
                imgElement.src = image.src; // Set the image source
                imgElement.alt = image.alt; // Set the alt text
                imgElement.style.maxWidth = '200px'; // Optional styling
                imgElement.style.margin = '10px';

                galleryElement.appendChild(imgElement);
            });
        })
        .catch(error => {
            console.error('There has been a problem with your fetch operation:', error);
        });
});
